"use client";

import React, { createContext, useContext, useEffect, useMemo, useState } from "react";

export type LanguageCode = "en" | "de";

type Dictionary = Record<string, string>;

type I18nDictionaries = Record<LanguageCode, Dictionary>;

const dictionaries: I18nDictionaries = {
  en: {
    appName: "MPU-Focus",
    adminPanel: "Admin Panel",
    // Global actions
    logout: "Logout",
    loading: "Loading...",
    cancel: "Cancel",
    delete: "Delete",
    close: "Close",
    save: "Save",
    update: "Update",
    create: "Create",
    previous: "Previous",
    next: "Next",
    viewLabel: "View:",
    list: "List",
    table: "Table",
    board: "Board",
    views: "Saved Views",
    selectView: "Select a view",
    noSavedViews: "No saved views",
    nameViewPrompt: "Name for this view:",
    viewSaved: "View saved.",
    columns: "Columns",
    chooseColumns: "Choose columns",
    details: "Details",
    overview: "Overview",
    col_name: "Name",
    col_email: "Email",
    col_role: "Role",
    col_verification: "Verification",
    col_progress: "Progress",
    col_created: "Created",
    col_lastLogin: "Last Login",
    dashboard: "Dashboard",
    progress: "Progress",
    search: "Search",
    email: "Email Address",
    password: "Password",
    signIn: "Sign In",
    signingIn: "Signing in...",
    loginFailedTitle: "Login Failed",
    loginFailedDesc: "Please check your credentials.",
    loginSuccessTitle: "Login Successful",
    redirecting: "Redirecting...",

    // Statuses
    status_pending: "Pending",
    status_documents_uploaded: "Documents Uploaded",
    status_contract_signed: "Under Review",
    status_resubmission_required: "Resubmission Required",
    status_verified: "Verified",
    status_rejected: "Rejected",
    status_unknown: "Unknown",

    // Document Processor
    documentProcessorTitle: "Document Processor",
    documentProcessorSubtitle: "Upload large PDF documents to extract structured data using OCR and AI analysis",
    choosePdfOrDrag: "Choose PDF file or drag and drop",
    supportsUpTo: "Supports PDF files up to 100MB (auto-optimized upload)",
    processDocument: "Process Document",
    processing: "Processing...",
    processingComplete: "Processing Complete",
    extractedData: "Extracted Data:",
    generatePdf: "Generate PDF Report",
    downloadHtml: "Download HTML",
    processAnother: "Process Another Document",
    copyExtracted: "Copy Extracted Data",
    docProc_processingForUser: "Processing for user",
    docProc_resultsAutosaved: "Results will be automatically saved to this user's account",
    unknownUser: "Unknown User",

    // Login
    loginTitle: "Login",
    loginSubtitle: "Sign in with your credentials",
    placeholderEmail: "your.email@example.com",
    placeholderPassword: "Your password",

    // Dashboard
    welcome: "Welcome",
    trainingDashboard: "Your Training Dashboard",
    trainingDashboardSub: "Track progress, access your course, and complete verification.",
    accountStatus: "Account Status:",
    overallProgress: "Overall Progress",
    chapters: "Chapters",
    completed: "Completed",
    account: "Account",
    verificationStatus: "Verification status",
    accountVerificationRequired: "Account Verification Required",
    verificationSteps: "Please complete verification steps below to upload your documents and sign the service agreement.",
    docsUploadedMsg: "Your documents have been uploaded. Please complete the contract signing process.",
    underReviewMsg: "Your documents and contract are being reviewed by our team. This typically takes 1–2 business days.",
    resubmissionMsg: "Your documents need to be updated. Please upload new documents. Your contract signature remains valid.",
    rejectedMsg: "Your submission was rejected. Please contact support for more information and to resubmit.",
    defaultVerificationMsg: "Please complete the verification process to access your account.",
    uploadId: "Upload a clear photo of your ID/passport",
    signAgreement: "Sign the service agreement digitally",
    reviewTimeline: "We will review within 1–2 business days",
    startVerificationNow: "Start Verification Now",
    uploadNewDocuments: "Upload New Documents",
    yourCourse: "Your Course",
    continueTraining: "Continue your training progress",
    courseAccessPending: "Course access pending verification",
    courseAccessLocked: "Course Access Locked",
    completeVerificationToAccess: "Complete your account verification to access the full course.",
    startVerification: "Start Verification",
    continue: "Continue",
    watchVideosAndTrack: "Watch videos, track your progress, and complete your training",
    orSelectVideo: "or select a video from the left to begin",
    identityDocument: "Identity Document",
    approved: "Approved",
    rejected: "Rejected - Please resubmit",
    underReview: "Under review",
    notUploaded: "Not uploaded",
    serviceAgreement: "Service Agreement",
    signed: "Signed",
    notSigned: "Not signed",
    accountVerification: "Account Verification",
    complete: "Complete",
    inProgress: "In progress",

    // Course page
    loadingYourCourse: "Loading your course...",
    noCourseTitle: "No Course Available",
    noCourseDesc: "There are no courses available at this time.",
    videoOf: "Video {current} of {total}",
    contentLockedTitle: "Content Locked",
    contentLockedDesc: "Complete previous chapters to unlock this content.",
    courseContent: "Course Content",
    current: "Current",
    locked: "Locked",
    videosCount: "{count} videos",
    resumeCourse: "Resume Course",
    continueWhereLeftOff: "Continue where you left off",
    campusTitle: "MPU Focus Campus",
    startCourse: "Start Course",
    resume: "Resume",
    start: "Start",
    back: "Back",
    lessons: "Lessons",
    modulesCount: "{count} modules",
    lessonsCount: "{done}/{total} lessons",
    videoNotAvailable: "Video not available",
    descriptionLabel: "Description",
    bookFreeConsultation: "Book free consultation",
    moduleProgress: "Module Progress",
    moduleDescription: "Module Description",
    pickLessonPrompt: "Select a lesson or use Next/Back.",
    nextSteps: "Next Steps",
    nextStepsSubtitle: "Begin with the next lesson",
    continueInModule: "Continue in module",

    // Admin
    nav_dashboard: "Dashboard",
    nav_users: "User Management",
    nav_leads: "Lead Management",
    nav_verification: "Verification",
    nav_chapters: "Modules",
    nav_videos: "Videos",
    nav_dashboard_desc: "Overview and statistics",
    nav_users_desc: "Manage users and track progress",
    nav_leads_desc: "Manage and convert leads",
    nav_verification_desc: "Review user verification submissions",
    nav_chapters_desc: "Manage course modules",
    nav_videos_desc: "Manage course videos",
    adminOverviewTitle: "Dashboard Overview",
    adminOverviewDesc: "Welcome to the admin dashboard. Here's a quick overview of your system.",
    totalUsers: "Total Users",
    activeUsers: "Active Users",
    registeredUsers: "Registered users",
    recentlyActive: "Recently active",
    manageUsers: "Manage Users",
    newLeads: "New Leads",
    success: "Success",
    error: "Error",
    unexpectedError: "An unexpected error occurred",

    // Admin: User Management
    userManagement: "User Management",
    manageUsersDesc: "Manage all users and track their progress",
    searchUsers: "Search Users",
    role: "Role",
    allRoles: "All Roles",
    admin: "Admin",
    user: "User",
    verifiedUsers: "Verified Users",
    docsProcessed: "Docs Processed",
    admins: "Admins",
    noUsersFound: "No users found matching your criteria",
    selectUserToView: "Select a user to view details",
    createdLabel: "Created",
    lastLogin: "Last Login",
    progressLabel: "Progress",
    chaptersCompleted: "chapters completed",
    documentProcessingLabel: "Document Processing:",
    processedLabel: "Processed",
    noData: "No Data",
    fileLabel: "File",
    processedAt: "Processed",
    pagesLabel: "Pages",
    adminNotesCount: "admin notes",
    progressBtn: "Progress",
    documentsBtn: "Documents",
    processBtn: "Process",
    pdfBtn: "PDF",
    notesBtn: "Notes",
    deleteBtn: "Delete",
    confirmDeletionTitle: "Confirm Deletion",
    confirmDeletionDesc: "Are you sure you want to delete this user? This action cannot be undone.",
    deleting: "Deleting...",
    pdfGenerated: "PDF Generated",
    pdfGenerationFailed: "PDF Generation Failed",
    noteAdded: "Note Added",
    noteDeleted: "Note Deleted",
    updateNotes: "Update Notes",
    existingNotes: "Existing Notes",
    addNewNote: "Add New Note",
    noteContent: "Note Content",
    privateNote: "Private note (not visible to user)",
    addNote: "Add Note",

    // Admin: Lead Management
    leadManagement: "Lead Management",
    manageLeadsDesc: "Manage leads from the enrollment process and convert them to users.",
    searchLeadsPlaceholder: "Search leads by name, email, or phone...",
    allStatus: "All Status",
    contacted: "Contacted",
    converted: "Converted",
    closed: "Closed",
    status_new: "New",
    status_contacted: "Contacted",
    status_converted: "Converted",
    status_closed: "Closed",
    contactHeader: "Contact",
    statusHeader: "Status",
    timeframeHeader: "Timeframe",
    createdHeader: "Created",
    actionsHeader: "Actions",
    loadingLeads: "Loading leads...",
    noLeadsFound: "No leads found",
    leadDetails: "Lead Details",
    viewAndManageLeadInfo: "View and manage lead information",
    name: "Name",
    emailLabel: "Email",
    phoneLabel: "Phone",
    updateStatus: "Update Status",
    notesLabel: "Notes",
    convertToUser: "Convert to User",
    setPasswordForUser: "Set Password for User",
    leaveEmptyToAutogenerate: "Leave empty to auto-generate",
    createUserAccount: "Create User Account",
    documentVerification: "Document Verification",
    sendVerificationEmail: "Send Verification Email",
    sending: "Sending...",
    verificationEmailSent: "Verification Email Sent",
    convertedToUser: "Converted to User",
    convertedOn: "Converted on:",
    pageOf: "Page {page} of {pages}",
    totalLeads: "({total} total leads)",

    // Admin: Video Management
    videoManagement: "Video Management",
    manageVideosDesc: "Manage course videos and their Mux integration",
    addVideo: "Add Video",
    editVideo: "Edit Video",
    addNewVideo: "Add New Video",
    videoTitle: "Video Title",
    enterVideoTitle: "Enter video title",
    description: "Description",
    enterDescription: "Enter video description",
    muxAssetId: "Mux Asset ID",
    enterMuxAssetId: "Enter Mux Asset ID (from Mux dashboard)",
    findMuxHint: "Find this in your Mux dashboard under Assets. It looks like: abcd1234efgh5678",
    order: "Order",
    chapter: "Module",
    selectChapter: "Select a module",
    noChaptersAvailable: "No modules available. Please create modules first.",
    updateVideo: "Update Video",
    createVideo: "Create Video",
    noVideosFound: "No videos found. Create your first video to get started.",
    orderLabel: "Order:",
    duration: "Duration:",
    mux: "Mux:",
    confirmDeleteVideo: "Are you sure you want to delete this video? This action cannot be undone.",
    videoDeleted: "Video deleted successfully",
    muxSynced: "Mux asset synced successfully",
    failedToSyncMux: "Failed to sync Mux asset",
    noMuxAsset: "No Mux Asset",
    ready: "Ready",
    unknown: "Unknown",

    // Admin: Module Management
    chapterManagement: "Module Management",
    addChapter: "Add Module",
    editChapter: "Edit Module",
    addNewChapter: "Add New Module",
    chapterTitle: "Module Title",
    chapterDescription: "Description",
    chapterOrder: "Module Order",
    chaptersWillBePresented: "Modules will be presented to students in this order",
    updateChapter: "Update Module",
    createChapter: "Create Module",
    noChaptersFound: "No modules found. Create your first module to get started.",
    chapterDeleted: "Module deleted successfully",
    orderUpdated: "Module order updated",

    // Admin: Verification Management
    verificationManagement: "Verification Management",
    manageVerificationDesc: "Manage user verification documents and status",
    filters: "Filters",
    filterByStatus: "Filter by Status",
    allStatuses: "All Statuses",
    review: "Review",
    userVerificationReview: "User Verification Review",
    decision: "Decision",
    approve: "Approve",
    reject: "Reject",
    rejectionReason: "Reason for Rejection",
    allowResubmission: "Allow document re-submission (user won't need to sign contract again)",
    submitReview: "Submit Review",
    nameLabel: "Name",
    documentLabel: "Document",
    contractLabel: "Contract",
    uploaded: "Uploaded",
    missing: "Missing",
    signedLabel: "Signed",
    pendingLabel: "Pending",
    passportDocument: "Passport Document",
    notAvailablePreview: "Document not available for preview. Please contact support.",
    contractDetails: "Contract Details",
    signedAt: "Signed At",
    signatureMethod: "Signature Method",
    ipAddress: "IP Address",
    userAgent: "User Agent",
    digitalSignature: "Digital Signature",
    adminReview: "Admin Review",
    searchUsersPlaceholder: "Search by name or email...",

    // Additional User Management header cards
    docsProcessedHeader: "Docs Processed",

    // Verification page
    verificationPage_backToDashboard: "Back to Dashboard",
    verificationPage_verifyingLink: "Verifying your link...",
    verificationPage_invalidLinkTitle: "Invalid Link",
    verificationPage_invalidLinkDesc: "This verification link is invalid or has expired.",
    verificationPage_goToLogin: "Go to Login",
    verificationPage_welcomeUser: "Welcome {name}! Complete these steps to access your account.",
    verificationPage_stepsProgress: "{current}/4 steps",
    verificationPage_step1Title: "Step 1: Upload Identity Document",
    verificationPage_step1Desc: "Please upload a clear photo of your passport or national ID card.",
    verificationPage_resubmissionTitle: "Document Resubmission Required",
    verificationPage_resubmissionMessage1: "Your previous documents need to be updated. Please upload new documents below.",
    verificationPage_resubmissionMessageStrong: "Your contract signature remains valid.",
    verificationPage_reasonLabel: "Reason:",
    verificationPage_chooseFile: "Choose file to upload",
    verificationPage_supportedFormats: "Supported formats: JPEG, PNG, PDF (max 10MB)",
    verificationPage_uploading: "Uploading...",
    verificationPage_uploadDocument: "Upload Document",
    verificationPage_step2Title: "Step 2: Sign Service Agreement",
    verificationPage_step2Desc: "Please review and sign our service agreement to proceed.",
    verificationPage_agreementHeader: "MPU-Focus Service Agreement",
    verificationPage_agreement_1_title: "1. Service Description:",
    verificationPage_agreement_1_body: "MPU-Focus provides comprehensive preparation courses and materials for the Medical-Psychological Assessment (MPU).",
    verificationPage_agreement_2_title: "2. User Obligations:",
    verificationPage_agreement_2_body: "You agree to use the platform responsibly and provide accurate information during the course.",
    verificationPage_agreement_3_title: "3. Privacy & Data Protection:",
    verificationPage_agreement_3_body: "We handle your personal data in accordance with GDPR and our Privacy Policy.",
    verificationPage_agreement_4_title: "4. Course Access:",
    verificationPage_agreement_4_body: "Upon verification, you will receive full access to all course materials and support services.",
    verificationPage_agreement_5_title: "5. Cancellation:",
    verificationPage_agreement_5_body: "You may cancel your subscription according to the terms outlined in your payment agreement.",
    verificationPage_termsAgreeLabel: "I have read and agree to the service agreement and privacy policy",
    verificationPage_signatureCapturedTitle: "Signature Captured",
    verificationPage_signatureCapturedDesc: "Your digital signature has been captured successfully.",
    verificationPage_pleaseAgreeToTerms: "Please read and agree to the terms",
    verificationPage_pleaseProvideSignature: "Please provide your digital signature",
    verificationPage_signing: "Signing...",
    verificationPage_step3Title: "Step 3: Under Review",
    verificationPage_step3Desc: "Your documents are being reviewed by our team.",
    verificationPage_reviewInProgress: "Review in Progress",
    verificationPage_reviewInProgressDesc: "Our team is reviewing your uploaded documents and signed agreement. This typically takes 1-2 business days.",
    verificationPage_whatsNext: "What's next?",
    verificationPage_whatsNextDesc: "You'll receive an email notification once your verification is complete. You can then access your full account and begin your MPU preparation.",
    verificationPage_step4Title: "Verification Complete!",
    verificationPage_step4Desc1: "Your account has been verified and activated.",
    verificationPage_welcomeHeadline: "Welcome to MPU-Focus!",
    verificationPage_step4Desc2: "Your account has been successfully verified. You now have full access to all course materials and features.",
    verificationPage_accessYourDashboard: "Access Your Dashboard",
    verificationPage_failedToVerifyToken: "Failed to verify token",
    verificationPage_uploadTypeError: "Please upload a JPEG, PNG, or PDF file",
    verificationPage_uploadSizeError: "File size must be less than 10MB",
    verificationPage_uploadSuccess: "Document uploaded successfully",
    verificationPage_uploadFailed: "Failed to upload document",
    verificationPage_contractSignedSuccess: "Contract signed successfully. All steps completed — your account is ready for admin review.",
    verificationPage_signFailed: "Failed to sign contract",
    verificationPage_changeSignature: "Change Signature",
    verificationPage_yourDigitalSignature: "Your Digital Signature:",
    verificationPage_yourSignatureAlt: "Your signature",
    verificationPage_signAgreementButton: "Sign Agreement",
    verificationPage_stepLabelUploadId: "Upload ID",
    verificationPage_stepLabelSignContract: "Sign Contract",
    verificationPage_stepLabelReview: "Review",
    verificationPage_stepLabelComplete: "Complete",

  },
  de: {
    appName: "MPU-Focus",
    adminPanel: "Admin Bereich",
    // Global actions
    logout: "Abmelden",
    loading: "Laden...",
    cancel: "Abbrechen",
    delete: "Löschen",
    close: "Schließen",
    save: "Speichern",
    update: "Aktualisieren",
    create: "Erstellen",
    previous: "Zurück",
    next: "Weiter",
    viewLabel: "Ansicht:",
    list: "Liste",
    table: "Tabelle",
    board: "Board",
    views: "Ansichten",
    selectView: "Ansicht wählen",
    noSavedViews: "Keine gespeicherten Ansichten",
    nameViewPrompt: "Name der Ansicht:",
    viewSaved: "Ansicht gespeichert.",
    columns: "Spalten",
    chooseColumns: "Spalten auswählen",
    details: "Details",
    overview: "Übersicht",
    col_name: "Name",
    col_email: "E-Mail",
    col_role: "Rolle",
    col_verification: "Verifizierung",
    col_progress: "Fortschritt",
    col_created: "Erstellt",
    col_lastLogin: "Letzte Anmeldung",
    dashboard: "Dashboard",
    progress: "Fortschritt",
    search: "Suche",
    email: "E-Mail-Adresse",
    password: "Passwort",
    signIn: "Anmelden",
    signingIn: "Anmeldung...",
    loginFailedTitle: "Anmeldung fehlgeschlagen",
    loginFailedDesc: "Bitte Zugangsdaten prüfen.",
    loginSuccessTitle: "Anmeldung erfolgreich",
    redirecting: "Weiterleiten...",

    // Statuses
    status_pending: "Ausstehend",
    status_documents_uploaded: "Dokumente hochgeladen",
    status_contract_signed: "In Prüfung",
    status_resubmission_required: "Erneute Einreichung erforderlich",
    status_verified: "Verifiziert",
    status_rejected: "Abgelehnt",
    status_unknown: "Unbekannt",

    // Document Processor
    documentProcessorTitle: "Dokumentenverarbeitung",
    documentProcessorSubtitle: "Lade große PDF-Dokumente hoch, um strukturierte Daten mit OCR und KI zu extrahieren",
    choosePdfOrDrag: "PDF auswählen oder hierher ziehen",
    supportsUpTo: "Unterstützt PDF-Dateien bis 100MB (automatisch optimiert)",
    processDocument: "Dokument verarbeiten",
    processing: "Verarbeitung...",
    processingComplete: "Verarbeitung abgeschlossen",
    extractedData: "Extrahierte Daten:",
    generatePdf: "PDF generieren",
    downloadHtml: "HTML herunterladen",
    processAnother: "Weiteres Dokument verarbeiten",
    copyExtracted: "Extrahierte Daten kopieren",
    docProc_processingForUser: "Verarbeitung für Nutzer",
    docProc_resultsAutosaved: "Ergebnisse werden automatisch im Benutzerkonto gespeichert",
    unknownUser: "Unbekannter Nutzer",

    // Login
    loginTitle: "Anmeldung",
    loginSubtitle: "Melden Sie sich mit Ihren Zugangsdaten an",
    placeholderEmail: "ihre.email@beispiel.de",
    placeholderPassword: "Ihr Passwort",

    // Dashboard
    welcome: "Willkommen",
    trainingDashboard: "Ihr Trainings-Dashboard",
    trainingDashboardSub: "Verfolgen Sie den Fortschritt, greifen Sie auf den Kurs zu und schließen Sie die Verifizierung ab.",
    accountStatus: "Kontostatus:",
    overallProgress: "Gesamtfortschritt",
    chapters: "Kapitel",
    completed: "Abgeschlossen",
    account: "Konto",
    verificationStatus: "Verifizierungsstatus",
    accountVerificationRequired: "Kontoverifizierung erforderlich",
    verificationSteps: "Bitte schließen Sie die folgenden Schritte ab, um Dokumente hochzuladen und die Vereinbarung zu unterschreiben.",
    docsUploadedMsg: "Ihre Dokumente wurden hochgeladen. Bitte schließen Sie die Vertragsunterzeichnung ab.",
    underReviewMsg: "Ihre Dokumente und der Vertrag werden geprüft. Dies dauert in der Regel 1–2 Werktage.",
    resubmissionMsg: "Ihre Dokumente müssen aktualisiert werden. Bitte neue Dokumente hochladen. Ihre Unterschrift bleibt gültig.",
    rejectedMsg: "Ihre Einreichung wurde abgelehnt. Bitte wenden Sie sich für weitere Informationen an den Support.",
    defaultVerificationMsg: "Bitte schließen Sie die Verifizierung ab, um Zugriff zu erhalten.",
    uploadId: "Laden Sie ein klares Foto Ihres Ausweises/Passes hoch",
    signAgreement: "Unterschreiben Sie die Dienstleistungsvereinbarung digital",
    reviewTimeline: "Wir prüfen innerhalb von 1–2 Werktagen",
    startVerificationNow: "Jetzt verifizieren",
    uploadNewDocuments: "Neue Dokumente hochladen",
    yourCourse: "Ihr Kurs",
    continueTraining: "Setzen Sie Ihren Lernfortschritt fort",
    courseAccessPending: "Kurszugang wartet auf Verifizierung",
    courseAccessLocked: "Kurszugang gesperrt",
    completeVerificationToAccess: "Schließen Sie die Verifizierung ab, um Zugriff zu erhalten.",
    startVerification: "Verifizierung starten",
    continue: "Weiter",
    watchVideosAndTrack: "Videos ansehen, Fortschritt verfolgen und Training abschließen",
    orSelectVideo: "oder wählen Sie links ein Video aus, um zu beginnen",
    identityDocument: "Ausweisdokument",
    approved: "Genehmigt",
    rejected: "Abgelehnt - Bitte erneut einreichen",
    underReview: "In Prüfung",
    notUploaded: "Nicht hochgeladen",
    serviceAgreement: "Dienstleistungsvertrag",
    signed: "Unterzeichnet",
    notSigned: "Nicht unterzeichnet",
    accountVerification: "Kontoverifizierung",
    complete: "Abschließen",
    inProgress: "In Bearbeitung",

    // Course page
    loadingYourCourse: "Kurs wird geladen...",
    noCourseTitle: "Kein Kurs verfügbar",
    noCourseDesc: "Derzeit sind keine Kurse verfügbar.",
    videoOf: "Video {current} von {total}",
    contentLockedTitle: "Inhalt gesperrt",
    contentLockedDesc: "Schließen Sie vorherige Kapitel ab, um diesen Inhalt freizuschalten.",
    courseContent: "Kursinhalt",
    current: "Aktuell",
    locked: "Gesperrt",
    videosCount: "{count} Videos",
    resumeCourse: "Kurs fortsetzen",
    continueWhereLeftOff: "Weiterlernen",
    campusTitle: "MPU Focus Campus",
    startCourse: "Kurs starten",
    resume: "Weiter",
    start: "Starten",
    back: "Zurück",
    lessons: "Lektionen",
    modulesCount: "{count} Module",
    lessonsCount: "{done}/{total} Lektionen",
    videoNotAvailable: "Video nicht verfügbar",
    descriptionLabel: "Beschreibung",
    bookFreeConsultation: "Kostenlose Beratung buchen",
    moduleProgress: "Modulfortschritt",
    moduleDescription: "Modulbeschreibung",
    pickLessonPrompt: "Wähle eine Lektion aus oder nutze Weiter/Zürück.",
    nextSteps: "Nächste Schritte",
    nextStepsSubtitle: "Beginne mit der nächsten Lektion",
    continueInModule: "Weiter in Modul",

    // Admin
    nav_dashboard: "Dashboard",
    nav_users: "Benutzerverwaltung",
    nav_leads: "Leadverwaltung",
    nav_verification: "Verifizierung",
    nav_chapters: "Module",
    nav_videos: "Videos",
    nav_dashboard_desc: "Übersicht und Statistiken",
    nav_users_desc: "Benutzer verwalten und Fortschritt verfolgen",
    nav_leads_desc: "Leads verwalten und konvertieren",
    nav_verification_desc: "Verifizierungen prüfen",
    nav_chapters_desc: "Kursmodule verwalten",
    nav_videos_desc: "Kursvideos verwalten",
    adminOverviewTitle: "Dashboard Übersicht",
    adminOverviewDesc: "Willkommen im Admin-Dashboard. Hier ist ein kurzer Überblick über Ihr System.",
    totalUsers: "Gesamtbenutzer",
    activeUsers: "Aktive Benutzer",
    registeredUsers: "Registrierte Benutzer",
    recentlyActive: "Kürzlich aktiv",
    manageUsers: "Benutzer verwalten",
    newLeads: "Neue Leads",
    success: "Erfolg",
    error: "Fehler",
    unexpectedError: "Ein unerwarteter Fehler ist aufgetreten",

    // Admin: User Management
    userManagement: "Benutzerverwaltung",
    manageUsersDesc: "Alle Benutzer verwalten und deren Fortschritt verfolgen",
    searchUsers: "Benutzer suchen",
    role: "Rolle",
    allRoles: "Alle Rollen",
    admin: "Admin",
    user: "Benutzer",
    verifiedUsers: "Verifizierte Benutzer",
    docsProcessed: "Dokumente verarbeitet",
    admins: "Admins",
    noUsersFound: "Keine Benutzer gefunden",
    selectUserToView: "Wählen Sie einen Benutzer aus, um Details anzuzeigen",
    createdLabel: "Erstellt",
    lastLogin: "Letzte Anmeldung",
    progressLabel: "Fortschritt",
    chaptersCompleted: "Kapitel abgeschlossen",
    documentProcessingLabel: "Dokumentenverarbeitung:",
    processedLabel: "Verarbeitet",
    noData: "Keine Daten",
    fileLabel: "Datei",
    processedAt: "Verarbeitet",
    pagesLabel: "Seiten",
    adminNotesCount: "Admin-Notizen",
    progressBtn: "Fortschritt",
    documentsBtn: "Dokumente",
    processBtn: "Verarbeiten",
    pdfBtn: "PDF",
    notesBtn: "Notizen",
    deleteBtn: "Löschen",
    confirmDeletionTitle: "Löschen bestätigen",
    confirmDeletionDesc: "Sind Sie sicher, dass Sie diesen Benutzer löschen möchten? Dies kann nicht rückgängig gemacht werden.",
    deleting: "Lösche...",
    pdfGenerated: "PDF generiert",
    pdfGenerationFailed: "PDF-Erstellung fehlgeschlagen",
    noteAdded: "Notiz hinzugefügt",
    noteDeleted: "Notiz gelöscht",
    updateNotes: "Notizen aktualisieren",
    existingNotes: "Bestehende Notizen",
    addNewNote: "Neue Notiz hinzufügen",
    noteContent: "Notizinhalte",
    privateNote: "Private Notiz (für Benutzer nicht sichtbar)",
    addNote: "Notiz hinzufügen",

    // Admin: Lead Management
    leadManagement: "Leadverwaltung",
    manageLeadsDesc: "Leads aus dem Anmeldeprozess verwalten und zu Benutzern konvertieren.",
    searchLeadsPlaceholder: "Leads nach Name, E-Mail oder Telefon suchen...",
    allStatus: "Alle Status",
    contacted: "Kontaktiert",
    converted: "Konvertiert",
    closed: "Geschlossen",
    status_new: "Neu",
    status_contacted: "Kontaktiert",
    status_converted: "Konvertiert",
    status_closed: "Geschlossen",
    contactHeader: "Kontakt",
    statusHeader: "Status",
    timeframeHeader: "Zeitrahmen",
    createdHeader: "Erstellt",
    actionsHeader: "Aktionen",
    loadingLeads: "Leads werden geladen...",
    noLeadsFound: "Keine Leads gefunden",
    leadDetails: "Lead-Details",
    viewAndManageLeadInfo: "Lead-Informationen anzeigen und verwalten",
    name: "Name",
    emailLabel: "E-Mail",
    phoneLabel: "Telefon",
    updateStatus: "Status aktualisieren",
    notesLabel: "Notizen",
    convertToUser: "Zu Benutzer konvertieren",
    setPasswordForUser: "Passwort für Benutzer festlegen",
    leaveEmptyToAutogenerate: "Leer lassen für automatische Erstellung",
    createUserAccount: "Benutzerkonto erstellen",
    documentVerification: "Dokumentenverifizierung",
    sendVerificationEmail: "Verifizierungs-E-Mail senden",
    sending: "Sende...",
    verificationEmailSent: "Verifizierungs-E-Mail gesendet",
    convertedToUser: "Zu Benutzer konvertiert",
    convertedOn: "Konvertiert am:",
    pageOf: "Seite {page} von {pages}",
    totalLeads: "({total} Leads gesamt)",

    // Admin: Video Management
    videoManagement: "Videoverwaltung",
    manageVideosDesc: "Kursvideos und deren Mux-Integration verwalten",
    addVideo: "Video hinzufügen",
    editVideo: "Video bearbeiten",
    addNewVideo: "Neues Video hinzufügen",
    videoTitle: "Videotitel",
    enterVideoTitle: "Videotitel eingeben",
    description: "Beschreibung",
    enterDescription: "Videobeschreibung eingeben",
    muxAssetId: "Mux Asset ID",
    enterMuxAssetId: "Mux Asset ID (aus dem Mux-Dashboard) eingeben",
    findMuxHint: "Im Mux-Dashboard unter Assets zu finden. Sieht z. B. so aus: abcd1234efgh5678",
    order: "Reihenfolge",
    chapter: "Modul",
    selectChapter: "Modul wählen",
    noChaptersAvailable: "Keine Module verfügbar. Bitte erstellen Sie zuerst Module.",
    updateVideo: "Video aktualisieren",
    createVideo: "Video erstellen",
    noVideosFound: "Keine Videos gefunden. Erstellen Sie Ihr erstes Video, um zu starten.",
    orderLabel: "Reihenfolge:",
    duration: "Dauer:",
    mux: "Mux:",
    confirmDeleteVideo: "Möchten Sie dieses Video wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden.",
    videoDeleted: "Video erfolgreich gelöscht",
    muxSynced: "Mux-Asset erfolgreich synchronisiert",
    failedToSyncMux: "Mux-Asset konnte nicht synchronisiert werden",
    noMuxAsset: "Kein Mux-Asset",
    ready: "Bereit",
    unknown: "Unbekannt",

    // Admin: Modulverwaltung
    chapterManagement: "Modulverwaltung",
    addChapter: "Modul hinzufügen",
    editChapter: "Modul bearbeiten",
    addNewChapter: "Neues Modul hinzufügen",
    chapterTitle: "Modultitel",
    chapterDescription: "Beschreibung",
    chapterOrder: "Modulreihenfolge",
    chaptersWillBePresented: "Module werden den Teilnehmern in dieser Reihenfolge angezeigt",
    updateChapter: "Modul aktualisieren",
    createChapter: "Modul erstellen",
    noChaptersFound: "Keine Module gefunden. Erstellen Sie Ihr erstes Modul, um zu starten.",
    chapterDeleted: "Modul erfolgreich gelöscht",
    orderUpdated: "Modulreihenfolge aktualisiert",

    // Admin: Verification Management
    verificationManagement: "Verifizierungsverwaltung",
    manageVerificationDesc: "Verifizierungsdokumente und -status der Benutzer verwalten",
    filters: "Filter",
    filterByStatus: "Nach Status filtern",
    allStatuses: "Alle Status",
    review: "Prüfen",
    userVerificationReview: "Benutzerverifizierung prüfen",
    decision: "Entscheidung",
    approve: "Genehmigen",
    reject: "Ablehnen",
    rejectionReason: "Begründung der Ablehnung",
    allowResubmission: "Erneute Dokumenteinreichung erlauben (Vertrag muss nicht erneut unterschrieben werden)",
    submitReview: "Prüfung absenden",
    nameLabel: "Name",
    documentLabel: "Dokument",
    contractLabel: "Vertrag",
    uploaded: "Hochgeladen",
    missing: "Fehlt",
    signedLabel: "Unterschrieben",
    pendingLabel: "Ausstehend",
    passportDocument: "Ausweisdokument",
    notAvailablePreview: "Dokument nicht für Vorschau verfügbar. Bitte Support kontaktieren.",
    contractDetails: "Vertragsdetails",
    signedAt: "Unterzeichnet am",
    signatureMethod: "Signaturmethode",
    ipAddress: "IP-Adresse",
    userAgent: "User-Agent",
    digitalSignature: "Digitale Signatur",
    adminReview: "Admin-Prüfung",
    searchUsersPlaceholder: "Suche nach Name oder E-Mail...",

    // Additional User Management header cards
    docsProcessedHeader: "Dokumente verarbeitet",

    // Verification page
    verificationPage_backToDashboard: "Zurück zum Dashboard",
    verificationPage_verifyingLink: "Ihr Link wird überprüft...",
    verificationPage_invalidLinkTitle: "Ungültiger Link",
    verificationPage_invalidLinkDesc: "Dieser Verifizierungslink ist ungültig oder abgelaufen.",
    verificationPage_goToLogin: "Zum Login",
    verificationPage_welcomeUser: "Willkommen {name}! Schließen Sie diese Schritte ab, um auf Ihr Konto zuzugreifen.",
    verificationPage_stepsProgress: "{current}/4 Schritte",
    verificationPage_step1Title: "Schritt 1: Ausweisdokument hochladen",
    verificationPage_step1Desc: "Bitte laden Sie ein klares Foto Ihres Reisepasses oder Personalausweises hoch.",
    verificationPage_resubmissionTitle: "Erneute Dokumenteinreichung erforderlich",
    verificationPage_resubmissionMessage1: "Ihre vorherigen Dokumente müssen aktualisiert werden. Bitte unten neue Dokumente hochladen.",
    verificationPage_resubmissionMessageStrong: "Ihre Vertragssignatur bleibt gültig.",
    verificationPage_reasonLabel: "Grund:",
    verificationPage_chooseFile: "Datei zum Hochladen auswählen",
    verificationPage_supportedFormats: "Unterstützte Formate: JPEG, PNG, PDF (max. 10 MB)",
    verificationPage_uploading: "Wird hochgeladen...",
    verificationPage_uploadDocument: "Dokument hochladen",
    verificationPage_step2Title: "Schritt 2: Dienstleistungsvertrag unterschreiben",
    verificationPage_step2Desc: "Bitte prüfen und unterschreiben Sie unseren Dienstleistungsvertrag, um fortzufahren.",
    verificationPage_agreementHeader: "MPU-Focus Dienstleistungsvertrag",
    verificationPage_agreement_1_title: "1. Leistungsbeschreibung:",
    verificationPage_agreement_1_body: "MPU-Focus bietet umfassende Vorbereitungskurse und Materialien für die Medizinisch-Psychologische Untersuchung (MPU).",
    verificationPage_agreement_2_title: "2. Pflichten der Nutzer:",
    verificationPage_agreement_2_body: "Sie verpflichten sich, die Plattform verantwortungsvoll zu nutzen und während des Kurses richtige Angaben zu machen.",
    verificationPage_agreement_3_title: "3. Datenschutz & Privatsphäre:",
    verificationPage_agreement_3_body: "Wir verarbeiten Ihre personenbezogenen Daten gemäß DSGVO und unserer Datenschutzerklärung.",
    verificationPage_agreement_4_title: "4. Kurszugang:",
    verificationPage_agreement_4_body: "Nach der Verifizierung erhalten Sie vollen Zugriff auf alle Kursmaterialien und Unterstützungsleistungen.",
    verificationPage_agreement_5_title: "5. Kündigung:",
    verificationPage_agreement_5_body: "Sie können Ihr Abonnement gemäß den Bedingungen Ihrer Zahlungsvereinbarung kündigen.",
    verificationPage_termsAgreeLabel: "Ich habe den Vertrag und die Datenschutzerklärung gelesen und stimme zu",
    verificationPage_signatureCapturedTitle: "Signatur erfasst",
    verificationPage_signatureCapturedDesc: "Ihre digitale Signatur wurde erfolgreich erfasst.",
    verificationPage_pleaseAgreeToTerms: "Bitte lesen und stimmen Sie den Bedingungen zu",
    verificationPage_pleaseProvideSignature: "Bitte geben Sie Ihre digitale Signatur an",
    verificationPage_signing: "Wird unterschrieben...",
    verificationPage_step3Title: "Schritt 3: In Prüfung",
    verificationPage_step3Desc: "Ihre Dokumente werden von unserem Team geprüft.",
    verificationPage_reviewInProgress: "Prüfung läuft",
    verificationPage_reviewInProgressDesc: "Unser Team prüft Ihre hochgeladenen Dokumente und die unterschriebene Vereinbarung. Dies dauert in der Regel 1–2 Werktage.",
    verificationPage_whatsNext: "Wie geht es weiter?",
    verificationPage_whatsNextDesc: "Sie erhalten eine E-Mail, sobald Ihre Verifizierung abgeschlossen ist. Danach können Sie vollständig auf Ihr Konto zugreifen und mit der MPU-Vorbereitung beginnen.",
    verificationPage_step4Title: "Verifizierung abgeschlossen!",
    verificationPage_step4Desc1: "Ihr Konto wurde verifiziert und aktiviert.",
    verificationPage_welcomeHeadline: "Willkommen bei MPU-Focus!",
    verificationPage_step4Desc2: "Ihre Verifizierung war erfolgreich. Sie haben nun vollen Zugriff auf alle Kursmaterialien und Funktionen.",
    verificationPage_accessYourDashboard: "Zum Dashboard",
    verificationPage_failedToVerifyToken: "Token konnte nicht verifiziert werden",
    verificationPage_uploadTypeError: "Bitte laden Sie eine JPEG-, PNG- oder PDF-Datei hoch",
    verificationPage_uploadSizeError: "Die Datei darf nicht größer als 10 MB sein",
    verificationPage_uploadSuccess: "Dokument erfolgreich hochgeladen",
    verificationPage_uploadFailed: "Dokument konnte nicht hochgeladen werden",
    verificationPage_contractSignedSuccess: "Vertrag erfolgreich unterschrieben. Alle Schritte abgeschlossen — Ihr Konto ist zur Admin-Prüfung bereit.",
    verificationPage_signFailed: "Vertrag konnte nicht unterschrieben werden",
    verificationPage_changeSignature: "Signatur ändern",
    verificationPage_yourDigitalSignature: "Ihre digitale Signatur:",
    verificationPage_yourSignatureAlt: "Ihre Signatur",
    verificationPage_signAgreementButton: "Vereinbarung unterschreiben",
    verificationPage_stepLabelUploadId: "Ausweis hochladen",
    verificationPage_stepLabelSignContract: "Vertrag unterschreiben",
    verificationPage_stepLabelReview: "Prüfung",
    verificationPage_stepLabelComplete: "Abschluss",

  }
};

interface I18nContextValue {
  lang: LanguageCode;
  t: (key: string, vars?: Record<string, string | number>) => string;
  setLang: (lang: LanguageCode) => void;
}

const I18nContext = createContext<I18nContextValue | undefined>(undefined);

export function I18nProvider({ children, initialLang = "de" as LanguageCode }: { children: React.ReactNode; initialLang?: LanguageCode }) {
  const [lang, setLangState] = useState<LanguageCode>(initialLang);

  useEffect(() => {
    const stored = typeof window !== 'undefined' ? (localStorage.getItem('app_lang') as LanguageCode | null) : null;
    if (stored && (stored === 'de' || stored === 'en')) {
      setLangState(stored);
    }
  }, []);

  useEffect(() => {
    if (typeof document !== 'undefined') {
      document.documentElement.lang = lang;
    }
    if (typeof window !== 'undefined') {
      localStorage.setItem('app_lang', lang);
    }
  }, [lang]);

  const setLang = (newLang: LanguageCode) => setLangState(newLang);

  const t = (key: string, vars?: Record<string, string | number>) => {
    const dict = dictionaries[lang] || {};
    let value = dict[key] || key;
    if (vars) {
      Object.keys(vars).forEach((k) => {
        value = value.replace(`{${k}}`, String(vars[k]));
      });
    }
    return value;
  };

  const value = useMemo(() => ({ lang, t, setLang }), [lang]);

  return (
    <I18nContext.Provider value={value}>
      {children}
    </I18nContext.Provider>
  );
}

export function useI18n() {
  const context = useContext(I18nContext);
  if (!context) {
    throw new Error("useI18n must be used within an I18nProvider");
  }
  return context;
}

export function LanguageSwitcher() {
  const { lang, setLang } = useI18n();
  return (
    <div className="inline-flex items-center gap-2 bg-white/90 border rounded-full px-3 py-1 shadow-sm">
      <button
        className={`text-sm ${lang === 'de' ? 'font-semibold' : 'opacity-70'}`}
        onClick={() => setLang('de')}
        aria-pressed={lang === 'de'}
      >
        DE
      </button>
      <span className="opacity-40">|</span>
      <button
        className={`text-sm ${lang === 'en' ? 'font-semibold' : 'opacity-70'}`}
        onClick={() => setLang('en')}
        aria-pressed={lang === 'en'}
      >
        EN
      </button>
    </div>
  );
}
