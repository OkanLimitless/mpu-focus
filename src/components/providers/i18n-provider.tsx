"use client";

import React, { createContext, useContext, useEffect, useMemo, useState } from "react";

export type LanguageCode = "de";

type Dictionary = Record<string, string>;

type I18nDictionaries = Record<LanguageCode, Dictionary>;

const dictionaries: I18nDictionaries = {

  de: {
    appName: "MPU-Focus",
    adminPanel: "Admin Bereich",
    // Global actions
    logout: "Abmelden",
    loading: "Laden...",
    cancel: "Abbrechen",
    delete: "Löschen",
    close: "Schließen",
    save: "Speichern",
    update: "Aktualisieren",
    create: "Erstellen",
    previous: "Zurück",
    next: "Weiter",
    viewLabel: "Ansicht:",
    list: "Liste",
    table: "Tabelle",
    board: "Board",
    views: "Ansichten",
    selectView: "Ansicht wählen",
    noSavedViews: "Keine gespeicherten Ansichten",
    nameViewPrompt: "Name der Ansicht:",
    viewSaved: "Ansicht gespeichert.",
    columns: "Spalten",
    chooseColumns: "Spalten auswählen",
    details: "Details",
    overview: "Übersicht",
    col_name: "Name",
    col_email: "E-Mail",
    col_role: "Rolle",
    col_verification: "Verifizierung",
    col_progress: "Fortschritt",
    col_created: "Erstellt",
    col_lastLogin: "Letzte Anmeldung",
    dashboard: "Dashboard",
    progress: "Fortschritt",
    search: "Suche",
    email: "E-Mail-Adresse",
    password: "Passwort",
    signIn: "Anmelden",
    signingIn: "Anmeldung...",
    loginFailedTitle: "Anmeldung fehlgeschlagen",
    loginFailedDesc: "Bitte Zugangsdaten prüfen.",
    loginSuccessTitle: "Anmeldung erfolgreich",
    redirecting: "Weiterleiten...",

    // Statuses
    status_pending: "Ausstehend",
    status_documents_uploaded: "Dokumente hochgeladen",
    status_contract_signed: "In Prüfung",
    status_resubmission_required: "Erneute Einreichung erforderlich",
    status_verified: "Verifiziert",
    status_rejected: "Abgelehnt",
    status_unknown: "Unbekannt",

    // Document Processor
    documentProcessorTitle: "Dokumentenverarbeitung",
    documentProcessorSubtitle: "Lade große PDF-Dokumente hoch, um strukturierte Daten mit OCR und KI zu extrahieren",
    choosePdfOrDrag: "PDF auswählen oder hierher ziehen",
    supportsUpTo: "Unterstützt PDF-Dateien bis 100MB (automatisch optimiert)",
    processDocument: "Dokument verarbeiten",
    processing: "Verarbeitung...",
    processingComplete: "Verarbeitung abgeschlossen",
    extractedData: "Extrahierte Daten:",
    generatePdf: "PDF generieren",
    downloadHtml: "HTML herunterladen",
    processAnother: "Weiteres Dokument verarbeiten",
    copyExtracted: "Extrahierte Daten kopieren",
    docProc_processingForUser: "Verarbeitung für Nutzer",
    docProc_resultsAutosaved: "Ergebnisse werden automatisch im Benutzerkonto gespeichert",
    unknownUser: "Unbekannter Nutzer",

    // Login
    loginTitle: "Anmeldung",
    loginSubtitle: "Melden Sie sich mit Ihren Zugangsdaten an",
    placeholderEmail: "ihre.email@beispiel.de",
    placeholderPassword: "Ihr Passwort",

    // Dashboard
    welcome: "Willkommen",
    trainingDashboard: "Ihr Trainings-Dashboard",
    trainingDashboardSub: "Verfolgen Sie den Fortschritt, greifen Sie auf den Kurs zu und schließen Sie die Verifizierung ab.",
    accountStatus: "Kontostatus:",
    overallProgress: "Gesamtfortschritt",
    chapters: "Kapitel",
    completed: "Abgeschlossen",
    account: "Konto",
    verificationStatus: "Verifizierungsstatus",
    accountVerificationRequired: "Kontoverifizierung erforderlich",
    verificationSteps: "Bitte schließen Sie die folgenden Schritte ab, um Dokumente hochzuladen und die Vereinbarung zu unterschreiben.",
    docsUploadedMsg: "Ihre Dokumente wurden hochgeladen. Bitte schließen Sie die Vertragsunterzeichnung ab.",
    underReviewMsg: "Ihre Dokumente und der Vertrag werden geprüft. Dies dauert in der Regel 1–2 Werktage.",
    resubmissionMsg: "Ihre Dokumente müssen aktualisiert werden. Bitte neue Dokumente hochladen. Ihre Unterschrift bleibt gültig.",
    rejectedMsg: "Ihre Einreichung wurde abgelehnt. Bitte wenden Sie sich für weitere Informationen an den Support.",
    defaultVerificationMsg: "Bitte schließen Sie die Verifizierung ab, um Zugriff zu erhalten.",
    uploadId: "Laden Sie ein klares Foto Ihres Ausweises/Passes hoch",
    signAgreement: "Unterschreiben Sie die Dienstleistungsvereinbarung digital",
    reviewTimeline: "Wir prüfen innerhalb von 1–2 Werktagen",
    startVerificationNow: "Jetzt verifizieren",
    uploadNewDocuments: "Neue Dokumente hochladen",
    yourCourse: "Ihr Kurs",
    continueTraining: "Setzen Sie Ihren Lernfortschritt fort",
    courseAccessPending: "Kurszugang wartet auf Verifizierung",
    courseAccessLocked: "Kurszugang gesperrt",
    completeVerificationToAccess: "Schließen Sie die Verifizierung ab, um Zugriff zu erhalten.",
    startVerification: "Verifizierung starten",
    continue: "Weiter",
    watchVideosAndTrack: "Videos ansehen, Fortschritt verfolgen und Training abschließen",
    orSelectVideo: "oder wählen Sie links ein Video aus, um zu beginnen",
    identityDocument: "Ausweisdokument",
    approved: "Genehmigt",
    rejected: "Abgelehnt - Bitte erneut einreichen",
    underReview: "In Prüfung",
    notUploaded: "Nicht hochgeladen",
    serviceAgreement: "Dienstleistungsvertrag",
    signed: "Unterzeichnet",
    notSigned: "Nicht unterzeichnet",
    accountVerification: "Kontoverifizierung",
    complete: "Abschließen",
    inProgress: "In Bearbeitung",

    // Course page
    loadingYourCourse: "Kurs wird geladen...",
    noCourseTitle: "Kein Kurs verfügbar",
    noCourseDesc: "Derzeit sind keine Kurse verfügbar.",
    videoOf: "Video {current} von {total}",
    contentLockedTitle: "Inhalt gesperrt",
    contentLockedDesc: "Schließen Sie vorherige Kapitel ab, um diesen Inhalt freizuschalten.",
    courseContent: "Kursinhalt",
    current: "Aktuell",
    locked: "Gesperrt",
    videosCount: "{count} Videos",
    resumeCourse: "Kurs fortsetzen",
    continueWhereLeftOff: "Weiterlernen",
    campusTitle: "MPU Focus Campus",
    startCourse: "Kurs starten",
    resume: "Weiter",
    start: "Starten",
    back: "Zurück",
    lessons: "Lektionen",
    modulesCount: "{count} Module",
    lessonsCount: "{done}/{total} Lektionen",
    videoNotAvailable: "Video nicht verfügbar",
    descriptionLabel: "Beschreibung",
    bookFreeConsultation: "Kostenlose Beratung buchen",
    moduleProgress: "Modulfortschritt",
    moduleDescription: "Modulbeschreibung",
    pickLessonPrompt: "Wähle eine Lektion aus oder nutze Weiter/Zürück.",
    quizTitle: "MPU Übungssitzung (Beta)",
    quizSubtitle: "Personalisierte Fragen basierend auf Ihrem Fall.",
    quizInstructions: "Wir synchronisieren Ihr Profil und erstellen einen Fragenkatalog. Dieses Übungstool unterstützt Lernen und Reflexion.",
    quizStartPractice: "Übung starten",
    quizProgress: "Frage {current} von {total}",
    quizSubmit: "Abschicken",
    quizFinish: "Beenden",
    quizFeedback: "Rückmeldung",
    strengths: "Stärken",
    gaps: "Lücken",
    nextActions: "Nächste Schritte",
    quizYourAnswer: "Ihre Antwort...",
    quizScore: "Ihr Ergebnis",
    practiceBeta: "Üben (Beta)",
    quizTab: "Quiz (Beta)",
    quizOverallScore: "Gesamtergebnis",
    quizCategoryScores: "Ergebnisse nach Kategorie",
    baselineTitle: "Persönliche Basisdaten (erforderlich)",
    baselineSubtitle: "Beantworte einige Fragen, um dein Training zu personalisieren.",
    startBaseline: "Basisdaten",
    completeBaseline: "Basisdaten abschließen",
    baselineSaved: "Deine Basisdaten wurden gespeichert.",
    baselineRequiredMsg: "Bitte vervollständige deine Basisdaten, um dein Training zu personalisieren und freizuschalten.",
    q_incident_summary: "Was ist passiert? Beschreibe den Vorfall in eigenen Worten.",
    q_substance_and_frequency: "Falls Substanzen beteiligt waren: welche und wie oft vor dem Vorfall?",
    q_bac_or_values: "Bekannte BAK/THC oder andere Werte (falls zutreffend)",
    q_abstinence_or_controlled_use: "Aktuelle Abstinenz oder kontrollierter Konsum: seit wann, wie stellst du das sicher?",
    q_therapy_or_support: "Therapie, Beratung oder Gruppe (was, wo, wie oft)",
    q_behavior_change_steps: "Welche konkreten Schritte hast du zur Verhaltensänderung unternommen?",
    q_risk_situations_and_strategies: "Typische Risikosituationen und deine Strategien",
    q_support_network: "Wer unterstützt dich (Familie, Freunde, Kolleg:innen, Berater:in)?",
    q_motivation_to_change: "Warum willst du etwas ändern? Was ist jetzt anders?",
    q_goals_and_next_steps: "Deine Ziele und nächsten Schritte bis zur MPU",
    resetQuizData: "Quiz-Daten zurücksetzen",
    hint_incident_summary: "Bleibe sachlich und knapp. Nenne Datum, Ort und Auslöser der Situation.",
    hint_substance_and_frequency: "Beschreibe Substanzart und Häufigkeit vor dem Vorfall möglichst realistisch.",
    hint_bac_or_values: "Falls bekannt, gib Werte an (z. B. 1,1‰ BAK, THC-Werte).",
    hint_abstinence_or_controlled_use: "Erkläre seit wann und wie du Abstinenz oder kontrollierten Konsum sicherstellst.",
    hint_therapy_or_support: "Nenne Therapie, Beratung, Selbsthilfegruppen und Häufigkeit.",
    hint_behavior_change_steps: "Liste konkrete Maßnahmen auf, die du umgesetzt hast (z. B. Routinen, Regeln).",
    hint_risk_situations_and_strategies: "Nenne typische Auslöser und wie du sie vermeidest oder bewältigst.",
    hint_support_network: "Wer ist in kritischen Momenten erreichbar und wie unterstützt man dich?",
    hint_motivation_to_change: "Was hat sich in deiner Haltung und im Alltag seit dem Vorfall geändert?",
    hint_goals_and_next_steps: "Was wirst du als Nächstes tun, um bis zur MPU stabil zu bleiben?",
    quizSessionDetails: "Quiz-Sitzungsdetails",
    nextSteps: "Nächste Schritte",
    nextStepsSubtitle: "Beginne mit der nächsten Lektion",
    continueInModule: "Weiter in Modul",
    quizRecommendations: "Empfehlungen",
    quizReviewMaterials: "Lernmaterial ansehen",
    goToModule: "Zum Modul",
    finishLater: "Später fortsetzen",
    stepOf: "Schritt {current} von {total}",
    cat_knowledge: "Wissen",
    cat_insight: "Einsicht",
    cat_behavior: "Verhalten",
    cat_consistency: "Kohärenz",
    cat_planning: "Planung",

    // Admin
    nav_dashboard: "Dashboard",
    nav_users: "Benutzerverwaltung",
    nav_leads: "Leadverwaltung",
    nav_verification: "Verifizierung",
    nav_chapters: "Module",
    nav_videos: "Videos",
    nav_dashboard_desc: "Übersicht und Statistiken",
    nav_users_desc: "Benutzer verwalten und Fortschritt verfolgen",
    nav_leads_desc: "Leads verwalten und konvertieren",
    nav_verification_desc: "Verifizierungen prüfen",
    nav_chapters_desc: "Kursmodule verwalten",
    nav_videos_desc: "Kursvideos verwalten",
    adminOverviewTitle: "Dashboard Übersicht",
    adminOverviewDesc: "Willkommen im Admin-Dashboard. Hier ist ein kurzer Überblick über Ihr System.",
    totalUsers: "Gesamtbenutzer",
    activeUsers: "Aktive Benutzer",
    registeredUsers: "Registrierte Benutzer",
    recentlyActive: "Kürzlich aktiv",
    manageUsers: "Benutzer verwalten",
    newLeads: "Neue Leads",
    success: "Erfolg",
    error: "Fehler",
    unexpectedError: "Ein unerwarteter Fehler ist aufgetreten",

    // Admin: User Management
    userManagement: "Benutzerverwaltung",
    manageUsersDesc: "Alle Benutzer verwalten und deren Fortschritt verfolgen",
    searchUsers: "Benutzer suchen",
    role: "Rolle",
    allRoles: "Alle Rollen",
    admin: "Admin",
    user: "Benutzer",
    verifiedUsers: "Verifizierte Benutzer",
    docsProcessed: "Dokumente verarbeitet",
    admins: "Admins",
    noUsersFound: "Keine Benutzer gefunden",
    selectUserToView: "Wählen Sie einen Benutzer aus, um Details anzuzeigen",
    createdLabel: "Erstellt",
    lastLogin: "Letzte Anmeldung",
    progressLabel: "Fortschritt",
    chaptersCompleted: "Kapitel abgeschlossen",
    documentProcessingLabel: "Dokumentenverarbeitung:",
    processedLabel: "Verarbeitet",
    noData: "Keine Daten",
    fileLabel: "Datei",
    processedAt: "Verarbeitet",
    pagesLabel: "Seiten",
    adminNotesCount: "Admin-Notizen",
    progressBtn: "Fortschritt",
    documentsBtn: "Dokumente",
    processBtn: "Verarbeiten",
    pdfBtn: "PDF",
    notesBtn: "Notizen",
    deleteBtn: "Löschen",
    confirmDeletionTitle: "Löschen bestätigen",
    confirmDeletionDesc: "Sind Sie sicher, dass Sie diesen Benutzer löschen möchten? Dies kann nicht rückgängig gemacht werden.",
    deleting: "Lösche...",
    pdfGenerated: "PDF generiert",
    pdfGenerationFailed: "PDF-Erstellung fehlgeschlagen",
    noteAdded: "Notiz hinzugefügt",
    noteDeleted: "Notiz gelöscht",
    updateNotes: "Notizen aktualisieren",
    existingNotes: "Bestehende Notizen",
    addNewNote: "Neue Notiz hinzufügen",
    noteContent: "Notizinhalte",
    privateNote: "Private Notiz (für Benutzer nicht sichtbar)",
    addNote: "Notiz hinzufügen",

    // Admin: Lead Management
    leadManagement: "Leadverwaltung",
    manageLeadsDesc: "Leads aus dem Anmeldeprozess verwalten und zu Benutzern konvertieren.",
    searchLeadsPlaceholder: "Leads nach Name, E-Mail oder Telefon suchen...",
    allStatus: "Alle Status",
    contacted: "Kontaktiert",
    converted: "Konvertiert",
    closed: "Geschlossen",
    status_new: "Neu",
    status_contacted: "Kontaktiert",
    status_converted: "Konvertiert",
    status_closed: "Geschlossen",
    contactHeader: "Kontakt",
    statusHeader: "Status",
    timeframeHeader: "Zeitrahmen",
    createdHeader: "Erstellt",
    actionsHeader: "Aktionen",
    loadingLeads: "Leads werden geladen...",
    noLeadsFound: "Keine Leads gefunden",
    leadDetails: "Lead-Details",
    viewAndManageLeadInfo: "Lead-Informationen anzeigen und verwalten",
    name: "Name",
    emailLabel: "E-Mail",
    phoneLabel: "Telefon",
    updateStatus: "Status aktualisieren",
    notesLabel: "Notizen",
    convertToUser: "Zu Benutzer konvertieren",
    setPasswordForUser: "Passwort für Benutzer festlegen",
    leaveEmptyToAutogenerate: "Leer lassen für automatische Erstellung",
    createUserAccount: "Benutzerkonto erstellen",
    documentVerification: "Dokumentenverifizierung",
    sendVerificationEmail: "Verifizierungs-E-Mail senden",
    sending: "Sende...",
    verificationEmailSent: "Verifizierungs-E-Mail gesendet",
    convertedToUser: "Zu Benutzer konvertiert",
    convertedOn: "Konvertiert am:",
    pageOf: "Seite {page} von {pages}",
    totalLeads: "({total} Leads gesamt)",

    // Admin: Video Management
    videoManagement: "Videoverwaltung",
    manageVideosDesc: "Kursvideos und deren Mux-Integration verwalten",
    addVideo: "Video hinzufügen",
    editVideo: "Video bearbeiten",
    addNewVideo: "Neues Video hinzufügen",
    videoTitle: "Videotitel",
    enterVideoTitle: "Videotitel eingeben",
    description: "Beschreibung",
    enterDescription: "Videobeschreibung eingeben",
    muxAssetId: "Mux Asset ID",
    enterMuxAssetId: "Mux Asset ID (aus dem Mux-Dashboard) eingeben",
    findMuxHint: "Im Mux-Dashboard unter Assets zu finden. Sieht z. B. so aus: abcd1234efgh5678",
    order: "Reihenfolge",
    chapter: "Modul",
    selectChapter: "Modul wählen",
    noChaptersAvailable: "Keine Module verfügbar. Bitte erstellen Sie zuerst Module.",
    updateVideo: "Video aktualisieren",
    createVideo: "Video erstellen",
    noVideosFound: "Keine Videos gefunden. Erstellen Sie Ihr erstes Video, um zu starten.",
    orderLabel: "Reihenfolge:",
    duration: "Dauer:",
    mux: "Mux:",
    confirmDeleteVideo: "Möchten Sie dieses Video wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden.",
    videoDeleted: "Video erfolgreich gelöscht",
    muxSynced: "Mux-Asset erfolgreich synchronisiert",
    failedToSyncMux: "Mux-Asset konnte nicht synchronisiert werden",
    noMuxAsset: "Kein Mux-Asset",
    ready: "Bereit",
    unknown: "Unbekannt",

    // Admin: Modulverwaltung
    chapterManagement: "Modulverwaltung",
    addChapter: "Modul hinzufügen",
    editChapter: "Modul bearbeiten",
    addNewChapter: "Neues Modul hinzufügen",
    chapterTitle: "Modultitel",
    chapterDescription: "Beschreibung",
    chapterOrder: "Modulreihenfolge",
    chaptersWillBePresented: "Module werden den Teilnehmern in dieser Reihenfolge angezeigt",
    updateChapter: "Modul aktualisieren",
    createChapter: "Modul erstellen",
    noChaptersFound: "Keine Module gefunden. Erstellen Sie Ihr erstes Modul, um zu starten.",
    chapterDeleted: "Modul erfolgreich gelöscht",
    orderUpdated: "Modulreihenfolge aktualisiert",

    // Admin: Verification Management
    verificationManagement: "Verifizierungsverwaltung",
    manageVerificationDesc: "Verifizierungsdokumente und -status der Benutzer verwalten",
    filters: "Filter",
    filterByStatus: "Nach Status filtern",
    allStatuses: "Alle Status",
    review: "Prüfen",
    userVerificationReview: "Benutzerverifizierung prüfen",
    decision: "Entscheidung",
    approve: "Genehmigen",
    reject: "Ablehnen",
    rejectionReason: "Begründung der Ablehnung",
    allowResubmission: "Erneute Dokumenteinreichung erlauben (Vertrag muss nicht erneut unterschrieben werden)",
    submitReview: "Prüfung absenden",
    nameLabel: "Name",
    documentLabel: "Dokument",
    contractLabel: "Vertrag",
    uploaded: "Hochgeladen",
    missing: "Fehlt",
    signedLabel: "Unterschrieben",
    pendingLabel: "Ausstehend",
    passportDocument: "Ausweisdokument",
    notAvailablePreview: "Dokument nicht für Vorschau verfügbar. Bitte Support kontaktieren.",
    contractDetails: "Vertragsdetails",
    signedAt: "Unterzeichnet am",
    signatureMethod: "Signaturmethode",
    ipAddress: "IP-Adresse",
    userAgent: "User-Agent",
    digitalSignature: "Digitale Signatur",
    adminReview: "Admin-Prüfung",
    searchUsersPlaceholder: "Suche nach Name oder E-Mail...",

    // Additional User Management header cards
    docsProcessedHeader: "Dokumente verarbeitet",

    // Verification page
    verificationPage_backToDashboard: "Zurück zum Dashboard",
    verificationPage_verifyingLink: "Ihr Link wird überprüft...",
    verificationPage_invalidLinkTitle: "Ungültiger Link",
    verificationPage_invalidLinkDesc: "Dieser Verifizierungslink ist ungültig oder abgelaufen.",
    verificationPage_goToLogin: "Zum Login",
    verificationPage_welcomeUser: "Willkommen {name}! Schließen Sie diese Schritte ab, um auf Ihr Konto zuzugreifen.",
    verificationPage_stepsProgress: "{current}/4 Schritte",
    verificationPage_step1Title: "Schritt 1: Ausweisdokument hochladen",
    verificationPage_step1Desc: "Bitte laden Sie ein klares Foto Ihres Reisepasses oder Personalausweises hoch.",
    verificationPage_resubmissionTitle: "Erneute Dokumenteinreichung erforderlich",
    verificationPage_resubmissionMessage1: "Ihre vorherigen Dokumente müssen aktualisiert werden. Bitte unten neue Dokumente hochladen.",
    verificationPage_resubmissionMessageStrong: "Ihre Vertragssignatur bleibt gültig.",
    verificationPage_reasonLabel: "Grund:",
    verificationPage_chooseFile: "Datei zum Hochladen auswählen",
    verificationPage_supportedFormats: "Unterstützte Formate: JPEG, PNG, PDF (max. 10 MB)",
    verificationPage_uploading: "Wird hochgeladen...",
    verificationPage_uploadDocument: "Dokument hochladen",
    verificationPage_step2Title: "Schritt 2: Dienstleistungsvertrag unterschreiben",
    verificationPage_step2Desc: "Bitte prüfen und unterschreiben Sie unseren Dienstleistungsvertrag, um fortzufahren.",
    verificationPage_agreementHeader: "MPU-Focus Dienstleistungsvertrag",
    verificationPage_agreement_1_title: "1. Leistungsbeschreibung:",
    verificationPage_agreement_1_body: "MPU-Focus bietet umfassende Vorbereitungskurse und Materialien für die Medizinisch-Psychologische Untersuchung (MPU).",
    verificationPage_agreement_2_title: "2. Pflichten der Nutzer:",
    verificationPage_agreement_2_body: "Sie verpflichten sich, die Plattform verantwortungsvoll zu nutzen und während des Kurses richtige Angaben zu machen.",
    verificationPage_agreement_3_title: "3. Datenschutz & Privatsphäre:",
    verificationPage_agreement_3_body: "Wir verarbeiten Ihre personenbezogenen Daten gemäß DSGVO und unserer Datenschutzerklärung.",
    verificationPage_agreement_4_title: "4. Kurszugang:",
    verificationPage_agreement_4_body: "Nach der Verifizierung erhalten Sie vollen Zugriff auf alle Kursmaterialien und Unterstützungsleistungen.",
    verificationPage_agreement_5_title: "5. Kündigung:",
    verificationPage_agreement_5_body: "Sie können Ihr Abonnement gemäß den Bedingungen Ihrer Zahlungsvereinbarung kündigen.",
    verificationPage_termsAgreeLabel: "Ich habe den Vertrag und die Datenschutzerklärung gelesen und stimme zu",
    verificationPage_signatureCapturedTitle: "Signatur erfasst",
    verificationPage_signatureCapturedDesc: "Ihre digitale Signatur wurde erfolgreich erfasst.",
    verificationPage_pleaseAgreeToTerms: "Bitte lesen und stimmen Sie den Bedingungen zu",
    verificationPage_pleaseProvideSignature: "Bitte geben Sie Ihre digitale Signatur an",
    verificationPage_signing: "Wird unterschrieben...",
    verificationPage_step3Title: "Schritt 3: In Prüfung",
    verificationPage_step3Desc: "Ihre Dokumente werden von unserem Team geprüft.",
    verificationPage_reviewInProgress: "Prüfung läuft",
    verificationPage_reviewInProgressDesc: "Unser Team prüft Ihre hochgeladenen Dokumente und die unterschriebene Vereinbarung. Dies dauert in der Regel 1–2 Werktage.",
    verificationPage_whatsNext: "Wie geht es weiter?",
    verificationPage_whatsNextDesc: "Sie erhalten eine E-Mail, sobald Ihre Verifizierung abgeschlossen ist. Danach können Sie vollständig auf Ihr Konto zugreifen und mit der MPU-Vorbereitung beginnen.",
    verificationPage_step4Title: "Verifizierung abgeschlossen!",
    verificationPage_step4Desc1: "Ihr Konto wurde verifiziert und aktiviert.",
    verificationPage_welcomeHeadline: "Willkommen bei MPU-Focus!",
    verificationPage_step4Desc2: "Ihre Verifizierung war erfolgreich. Sie haben nun vollen Zugriff auf alle Kursmaterialien und Funktionen.",
    verificationPage_accessYourDashboard: "Zum Dashboard",
    verificationPage_failedToVerifyToken: "Token konnte nicht verifiziert werden",
    verificationPage_uploadTypeError: "Bitte laden Sie eine JPEG-, PNG- oder PDF-Datei hoch",
    verificationPage_uploadSizeError: "Die Datei darf nicht größer als 10 MB sein",
    verificationPage_uploadSuccess: "Dokument erfolgreich hochgeladen",
    verificationPage_uploadFailed: "Dokument konnte nicht hochgeladen werden",
    verificationPage_contractSignedSuccess: "Vertrag erfolgreich unterschrieben. Alle Schritte abgeschlossen — Ihr Konto ist zur Admin-Prüfung bereit.",
    verificationPage_signFailed: "Vertrag konnte nicht unterschrieben werden",
    verificationPage_changeSignature: "Signatur ändern",
    verificationPage_yourDigitalSignature: "Ihre digitale Signatur:",
    verificationPage_yourSignatureAlt: "Ihre Signatur",
    verificationPage_signAgreementButton: "Vereinbarung unterschreiben",
    verificationPage_stepLabelUploadId: "Ausweis hochladen",
    verificationPage_stepLabelSignContract: "Vertrag unterschreiben",
    verificationPage_stepLabelReview: "Prüfung",
    verificationPage_stepLabelComplete: "Abschluss",

  }
};

interface I18nContextValue {
  lang: LanguageCode;
  t: (key: string, vars?: Record<string, string | number>) => string;
  setLang: (lang: LanguageCode) => void;
}

const I18nContext = createContext<I18nContextValue | undefined>(undefined);

export function I18nProvider({ children, initialLang = "de" as LanguageCode }: { children: React.ReactNode; initialLang?: LanguageCode }) {
  const [lang, setLangState] = useState<LanguageCode>(initialLang);

  useEffect(() => {
    const stored = typeof window !== 'undefined' ? (localStorage.getItem('app_lang') as LanguageCode | null) : null;
    if (stored && (stored === 'de' || stored === 'en')) {
      setLangState(stored);
    }
  }, []);

  useEffect(() => {
    if (typeof document !== 'undefined') {
      document.documentElement.lang = lang;
    }
    if (typeof window !== 'undefined') {
      localStorage.setItem('app_lang', lang);
    }
  }, [lang]);

  const setLang = (newLang: LanguageCode) => setLangState(newLang);

  const t = (key: string, vars?: Record<string, string | number>) => {
    const dict = dictionaries[lang] || {};
    let value = dict[key] || key;
    if (vars) {
      Object.keys(vars).forEach((k) => {
        value = value.replace(`{${k}}`, String(vars[k]));
      });
    }
    return value;
  };

  const value = useMemo(() => ({ lang, t, setLang }), [lang]);

  return (
    <I18nContext.Provider value={value}>
      {children}
    </I18nContext.Provider>
  );
}

export function useI18n() {
  const context = useContext(I18nContext);
  if (!context) {
    throw new Error("useI18n must be used within an I18nProvider");
  }
  return context;
}

